(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{dc02:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticStyle:{"margin-bottom":"16px"}},[o("a-button",{attrs:{type:"primary"},on:{click:e.showAdd}},[e._v("添加用户")])],1),o("a-table",{attrs:{"row-key":function(e){return e.id},columns:e.columns,"data-source":e.$store.state.usersModule.users,pagination:e.pagination,loading:e.$store.state.usersModule.loading,locale:{filterConfirm:"确定",filterReset:"重置",emptyText:"暂无数据"},bordered:"",scroll:{y:460}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"filterDropdown",fn:function(e){var t=e.setSelectedKeys,n=e.selectedKeys,r=e.confirm,a=e.clearFilters,l=e.column;return o("TableFilter",{attrs:{setSelectedKeys:t,selectedKeys:n,confirm:r,clearFilters:a,column:l}})}},{key:"filterIcon",fn:function(e){return o("a-icon",{style:{color:e?"#108ee9":void 0},attrs:{type:"search"}})}},{key:"enabled",fn:function(e){return[o("a-icon",e?{staticStyle:{"font-size":"24px"},attrs:{type:"check-circle",theme:"twoTone","two-tone-color":"#52c41a"}}:{staticStyle:{"font-size":"24px"},attrs:{type:"close-circle",theme:"twoTone","two-tone-color":"#eb2f96"}})]}},{key:"operation",fn:function(t,n){return[o("a-button",{attrs:{type:"link"},on:{click:function(t){return e.showEdit(n)}}},[e._v("编辑")]),o("a-popconfirm",{attrs:{title:"确认切换用户状态？","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(){return e.toggleUserEnabled(n.username)}}},[o("a-button",{attrs:{type:"link"}},[e._v(" "+e._s(n.enabled?"禁用":"启用")+" ")])],1),o("a-button",{attrs:{type:"link",disabled:!e.hasUpdateUserPermission||e.isSelf(n.username)},on:{click:function(t){return e.navToUserRoles(n.username)}}},[e._v("分配角色")])]}}])}),o("AddUserDialog",{attrs:{show:e.showAddDialog,record:e.addModel},on:{closed:function(t){e.showAddDialog=!1}}}),o("EditUserDialog",{attrs:{show:e.showEditDialog,record:e.editModel},on:{closed:function(t){e.showEditDialog=!1}}})],1)},r=[],a=o("f3f3"),l=function(){return[{title:"Id",dataIndex:"id"},{title:"用户名",dataIndex:"username",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"},sorter:!0},{title:"姓名",dataIndex:"name",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"},sorter:!0},{title:"手机号",dataIndex:"mobile",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"},sorter:!0},{title:"电子邮件",dataIndex:"email",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"},sorter:!0},{title:"激活",dataIndex:"enabled",scopedSlots:{customRender:"enabled"},align:"center",filters:[{text:"启用",value:"true"},{text:"禁用",value:"false"}]},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},align:"center"}]},i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-modal",{attrs:{title:"修改用户","on-ok":"handleOk"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[o("a-form-model",e._b({ref:"form",attrs:{model:e.model,rules:e.rules}},"a-form-model",e.layout,!1),[o("a-form-model-item",{attrs:{"has-feedback":"",prop:"name",label:"姓名"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),o("a-form-model-item",{attrs:{"has-feedback":"",prop:"email",label:"电子邮件"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1),o("a-form-model-item",{attrs:{"has-feedback":"",prop:"mobile",label:"手机"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.mobile,callback:function(t){e.$set(e.model,"mobile",t)},expression:"model.mobile"}})],1)],1),o("template",{slot:"footer"},[o("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("返回")]),o("a-button",{key:"submit",attrs:{type:"primary",loading:e.$store.state.usersModule.loading},on:{click:e.handleOk}},[e._v("确认")])],1)],2)},s=[],c=o("69ca"),u=function(e){return function(t,o,n){""===o&&n(),c["a"].checkEmail(o,e).then((function(e){e.data&&n(new Error("电子邮件已存在！")),n()})).catch((function(){n(new Error("服务器异常"))}))}},d=function(e){return function(t,o,n){""===o&&n(),c["a"].checkMobile(o,e).then((function(e){e.data&&n(new Error("手机号码已存在！")),n()})).catch((function(){n(new Error("服务器异常"))}))}},m=function(e){return{name:[{required:!0,message:"姓名为必填项",trigger:"blur"},{pattern:/^([\u4e00-\u9fa5]{2,20}|[a-zA-Z.\s]{2,50})$/,message:"中文姓名长度为2-20个字符，不能有空格。英文姓名在2-50个字符，可以有空格和小数点",trigger:"blur"}],mobile:[{required:!0,message:"手机号为必填项！",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号不合法",trigger:"blur"},{asyncValidator:d(e.username),trigger:"blur"}],email:[{required:!0,message:"电子邮件为必填项！",trigger:"blur"},{pattern:/^\S+@\S+\.\S+$/,message:"电子邮件地址不合法！",trigger:"blur"},{asyncValidator:u(e.username),trigger:"blur"}]}},f={props:{show:Boolean,record:Object},data:function(){return{layout:{labelCol:{span:4},wrapperCol:{span:12}}}},computed:{rules:function(){return m(this.model)},visible:{get:function(){return this.show},set:function(e){this.$emit("closed",e)}},model:{get:function(){return this.record}}},methods:{handleOk:function(){this.$emit("submitted",this.model),this.visible=!1},handleCancel:function(){this.visible=!1}}},p=f,b=o("2877"),h=Object(b["a"])(p,i,s,!1,null,null,null),g=h.exports,y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-modal",{attrs:{title:"添加用户","on-ok":"handleOk"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[o("a-form-model",e._b({ref:"form",attrs:{model:e.model,rules:e.rules}},"a-form-model",e.layout,!1),[o("a-form-model-item",{attrs:{"has-feedback":"",prop:"name",label:"姓名"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),o("a-form-model-item",{attrs:{"has-feedback":"",prop:"email",label:"电子邮件"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1),o("a-form-model-item",{attrs:{"has-feedback":"",prop:"mobile",label:"手机"}},[o("a-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.mobile,callback:function(t){e.$set(e.model,"mobile",t)},expression:"model.mobile"}})],1)],1),o("template",{slot:"footer"},[o("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("返回")]),o("a-button",{key:"submit",attrs:{type:"primary",loading:e.$store.state.usersModule.loading},on:{click:e.handleOk}},[e._v("确认")])],1)],2)},k=[],w=o("9962"),v=function(e,t,o){""===t&&o(),w["a"].checkUsername(t).then((function(e){e.data&&o(new Error("用户名已存在！")),o()})).catch((function(){o(new Error("服务器异常"))}))},x=function(e,t,o){""===t&&o(),w["a"].checkEmail(t).then((function(e){e.data&&o(new Error("电子邮件已存在！")),o()})).catch((function(){o(new Error("服务器异常"))}))},$=function(e,t,o){""===t&&o(),w["a"].checkMobile(t).then((function(e){e.data&&o(new Error("手机号码已存在！")),o()})).catch((function(){o(new Error("服务器异常"))}))},S=function(){return{username:[{required:!0,message:"用户名为必填项！",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]{3,50}$/,message:"用户名仅能使用英文字母和数字以及下划线，长度在3-50个字符",trigger:"blur"},{asyncValidator:v,trigger:"blur"}],name:[{required:!0,message:"姓名为必填项",trigger:"blur"},{pattern:/^([\u4e00-\u9fa5]{2,20}|[a-zA-Z.\s]{2,50})$/,message:"中文姓名长度为2-20个字符，不能有空格。英文姓名在2-50个字符，可以有空格和小数点",trigger:"blur"}],mobile:[{required:!0,message:"手机号为必填项！",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号不合法",trigger:"blur"},{asyncValidator:$,trigger:"blur"}],email:[{required:!0,message:"电子邮件为必填项！",trigger:"blur"},{pattern:/^\S+@\S+\.\S+$/,message:"电子邮件地址不合法！",trigger:"blur"},{asyncValidator:x,trigger:"blur"}]}},E={props:{show:Boolean},data:function(){return{layout:{labelCol:{span:4},wrapperCol:{span:12}},model:{username:"",name:"",mobile:"",email:""}}},computed:{rules:function(){return S()},visible:{get:function(){return this.show},set:function(e){this.$emit("closed",e)}}},methods:{handleOk:function(){this.$emit("submitted",this.model),this.visible=!1},handleCancel:function(){this.visible=!1}}},_=E,D=Object(b["a"])(_,y,k,!1,null,null,null),I=D.exports,M=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{padding:"8px"}},[o("a-input",{directives:[{name:"ant-ref",rawName:"v-ant-ref",value:function(t){return e.searchInput=t},expression:"(c) => (searchInput = c)"}],staticStyle:{width:"188px","margin-bottom":"8px",display:"block"},attrs:{"auto-focus":"",placeholder:"搜索 "+e.column.title,value:e.selectedKeys[0]},on:{change:function(t){return e.setSelectedKeys(t.target.value?[t.target.value]:[])}}}),o("a-button",{staticStyle:{width:"90px","margin-right":"8px"},attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){return e.confirm()}}},[e._v(" 搜索 ")]),o("a-button",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{click:function(){return e.clearFilters()}}},[e._v(" 清除 ")])],1)},O=[],A=function(e){return function(t){t&&setTimeout((function(){e.focus()}),0)}},C={props:{setSelectedKeys:Function,selectedKeys:Array,confirm:Function,clearFilters:Function,column:Object},data:function(){return{searchInput:null}},methods:{},mounted:function(){this.$nextTick((function(){this.column.onFilterDropdownVisibleChange=A(this.searchInput)}))}},T=C,U=Object(b["a"])(T,M,O,!1,null,null,null),F=U.exports,z={components:{EditUserDialog:g,AddUserDialog:I,TableFilter:F},data:function(){var e=this;return{showEditDialog:!1,editModel:{name:"",email:"",mobile:""},showAddDialog:!1,addModel:{username:"",name:"",email:"",mobile:""},pagination:{defaultPageSize:20,showTotal:function(){return"共 ".concat(e.$store.state.usersModule.total," 条数据")}}}},computed:{columns:function(){return l()}},methods:{handleAdd:function(e){console.log(e)},showAdd:function(){this.showAddDialog=!0},handleUpdate:function(e){console.log(e)},showEdit:function(e){this.showEditDialog=!0,this.editModel=Object(a["a"])({},e)},toggleUserEnabled:function(e){console.log(e)},navToUserRoles:function(e){this.$router.push({path:"/users/".concat(e)})},handleTableChange:function(e,t,o){this.pagination=e,this.$store.dispatch("usersModule/load",{page:e.current-1,offset:(e.current-1)*e.pageSize,sort:{field:o.field,order:o.order},filters:Object(a["a"])({},t)})}},mounted:function(){this.$store.dispatch("usersModule/load",{page:0,offset:0})}},j=z,K=Object(b["a"])(j,n,r,!1,null,null,null);t["default"]=K.exports}}]);
//# sourceMappingURL=users.f76aaab9.js.map